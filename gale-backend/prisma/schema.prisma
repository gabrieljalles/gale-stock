generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id           String              @id @default(cuid())
  name         String @unique
  description  String?
  category     Category
  tags         String[]
  sizeType     SizeType
  pack         Int
  size         String
  imgUrl       String
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt
  catalog      Catalog?
  LostEntry    LostEntry[]
  stockEntries StockEntryDetails[]
}

model Supplier {
  id                  String             @id @default(cuid())
  legalRepresentative String
  enterprise          String
  cellphone           String
  appName             String?
  city                String
  stockTransactions   StockTransaction[]
}

model StockTransaction {
  id                String                        @id @default(cuid())
  supplierId        String
  transactionType   TransactionType
  numberPayments    Int
  firstPaymentDate  DateTime?
  totalProductCost  Decimal @db.Decimal(10,2)
  freightCost Decimal @db.Decimal(10,2)
  feeCost Decimal     @db.Decimal(10,2)
  totalCost         Decimal @db.Decimal(10,2)
  statusCheckout    String
  createdAt         DateTime                      @default(now())
  updatedAt         DateTime                      @updatedAt
  stockEntryDetails StockEntryDetails[]
  supplier          Supplier                      @relation(fields: [supplierId], references: [id])
  installments      StockTransactionInstallment[]
}

model StockTransactionInstallment {
  id                 String           @id @default(cuid())
  stockTransactionId String
  installmentNumber  Int
  dueDate            DateTime
  paidDate           DateTime?
  fragmentCost      Decimal @db.Decimal(10,2)
  transaction        StockTransaction @relation(fields: [stockTransactionId], references: [id], onDelete: Cascade)
}

model StockEntryDetails {
  id               String           @id @default(cuid())
  productId        String
  productCost Decimal @db.Decimal(10,2)
  quantity         Int
  totalProductCost Decimal @db.Decimal(10,2)
  validityDate     DateTime
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  transactionId    String
  product          Product          @relation(fields: [productId], references: [id])
  stockTransaction StockTransaction @relation(fields: [transactionId], references: [id], onDelete: Cascade)
}

model LostEntry {
  id         String     @id @default(cuid())
  productId  String
  quantity   Int
  reasonLoss ReasonLoss
  note       String?
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  product    Product    @relation(fields: [productId], references: [id])
}

model Catalog {
  id                      String   @id
  finalConsumerPrice      Decimal @db.Decimal(10,2)
  finalIfoodConsumerPrice Decimal @db.Decimal(10,2)
  isLiquidation           Boolean @default(false)
  discountPrice           Decimal @db.Decimal(10,2)
  quantityDiscount        Int
  discountQtdPrice        Decimal @db.Decimal(10,2)
  stock                   Int
  available               Boolean  @default(true)
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  product                 Product  @relation(fields: [id], references: [id])
}

model DiscountCatalog { 
  id String @id @default(cuid())
  productId String
  InitialDate DateTime 
  FinalDate DateTime
}

model User{
  id String @id @default(cuid())
  fullName String
  cellPhone String
  email String @unique
  cpfCNPJ String
  accountType AccountType
  password String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model UserAddress{
  id String @id @default(cuid())
  userId String
  typeAddress TypeAddress
  address String
  number String
  complement String
  district String
  zipCode String
  lat String?
  lon String?
}

enum TypeAddress {
  Street
  Avanue
  Alley
  Lane
  Highway
  Road
  Square
  Village
  Condominium
}

enum AccountType {
  Owner
  DeliveryMan
  Client
}

enum SizeType {
  g
  L
  ml
  mg
  kg
  un
}

enum ReasonLoss {
  Theft
  DamegedProduct
  CustomerReturn
  Expiration
  Operacional
  Loss
}

enum Category {
  Beers
  Tobacco
  NonAlcoholic
  Spirits
  Candy
  FrozenFoods
  PharmacyPersonalCare
  Grocery
  Wines
  Snacks
  Others
}

enum TransactionType {
  BankSlip
  CreditCard
  Money
  Pix
  DebitCard
}
